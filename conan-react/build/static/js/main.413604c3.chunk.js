(this["webpackJsonpconan-react"]=this["webpackJsonpconan-react"]||[]).push([[0],{43:function(t,e,a){t.exports=a(72)},48:function(t,e,a){},50:function(t,e,a){},51:function(t,e,a){},54:function(t,e,a){},55:function(t,e,a){},72:function(t,e,a){"use strict";a.r(e);var s=a(1),n=a.n(s),r=a(36),o=a.n(r),i=(a(48),a(17)),c=a.n(i),l=a(9),u=a(20),f=a(16),h=(a(50),a(11)),d=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){if(a.isScaling)if(a.scalingTimeElapsed>=a.scalingTime)a.isScaling=!1,a.scalingTimeStart=null,a.scalingTimeElapsed=null;else{a.scalingTimeElapsed=e-a.scalingTimeStart;var s=a.scalingTime/a.scalingTimeElapsed;a.scale-=a.scale/a.scalingDivider*s}t.fillStyle=a.color,t.fillRect(0,0,a.width,a.height)},this.setWidth=function(t){a.width=t},this.setHeight=function(t){a.height=t},this.getCenter=function(t){return{x:Math.floor(a.width/2),y:Math.floor(a.height/2)}},this.isInside=function(t,e){var s=t<=a.width&&t>=0,n=e<=a.height&&e>=0;return s&&n},this.startScaleDown=function(t){a.isScaling=!0,a.scalingTimeStart=t},this.width=e.width?e.width:0,this.height=e.height?e.height:0,this.scale=e.scale?e.scale:1,this.color=e.color?e.color:"black",this.scalingTime=500,this.scalingDivider=4,this.scalingTimeElapsed=null,this.scalingTimeStart=null,this.isScaling=!1},p=(a(51),function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){t.strokeStyle=a.color;var s=!1;t.lineWidth=a.scaleFactor*a.surface.scale,t.beginPath(),t.moveTo(a.startX,a.startY);for(var n=0;n<a.positions.length-1&&!(a.positions[n].read_at>e);n++){var r=a.startX,o=a.startY;if(a.positions[n+1].read_at>e){var i=a.positions[n+1].read_at-a.positions[n].read_at,c=(e-a.positions[n].read_at)/i,l=(a.positions[n+1].x-a.positions[n].x)*c,u=(a.positions[n+1].y-a.positions[n].y)*c;r+=(a.positions[n].x+l)*a.stepFactor*a.surface.scale,o+=(a.positions[n].y+u)*a.stepFactor*a.surface.scale}else r+=a.positions[n+1].x*a.stepFactor*a.surface.scale,o+=a.positions[n+1].y*a.stepFactor*a.surface.scale;if(!a.surface.isInside(r,o)){a.surface.scale=Math.floor(a.surface.scale-a.surface.scale/4),s=!0;break}t.lineTo(r,o),t.stroke()}s&&(a.surface.draw(t),a.draw(t,e))},this.setStart=function(t,e){a.startX=t,a.startY=e},this.setSurface=function(t){a.surface=t},this.color=e.color?e.color:"black",this.collisionColor=e.collisionColor?e.collisionColor:"red",this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0,this.positions=e.positions,this.scaleFactor=e.scaleFactor,this.stepFactor=e.stepFactor}),m=function t(){var e=this;Object(h.a)(this,t),this.draw=function(t,a,s,n){e.scale=s,e.rotation=n;var r={x:a.x+Math.cos((90-e.rotation)*Math.PI/180)*e.scale,y:a.y+-Math.sin((90-e.rotation)*Math.PI/180)*e.scale},o={x:a.x+Math.cos(-e.rotation*Math.PI/180)*e.scale/2,y:a.y+-Math.sin(-e.rotation*Math.PI/180)*e.scale/2},i={x:a.x+Math.cos((180-e.rotation)*Math.PI/180)*e.scale/2,y:a.y+-Math.sin((180-e.rotation)*Math.PI/180)*e.scale/2};t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(o.x,o.y),t.lineTo(i.x,i.y),t.closePath(),t.strokeStyle="green",t.stroke(),t.fillStyle="green",t.fill()}},v=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){for(var s=null,n=null,r=a.startX,o=a.startY,i=0;i<a.transforms.length-1;i++){if(i===a.transforms.length-1||0===e){s=i,n=i;break}if(a.transforms[i+1].read_at>e){s=i,n=i+1;break}}var c=a.transforms[n].read_at-a.transforms[s].read_at,l=(e-a.transforms[s].read_at)/c,u=(a.transforms[n].x-a.transforms[s].x)*l,f=(a.transforms[n].y-a.transforms[s].y)*l;r+=(a.transforms[s].x+u)*a.stepFactor*a.surface.scale,o+=(a.transforms[s].y+f)*a.stepFactor*a.surface.scale;var h=(a.transforms[n].rotation-a.transforms[s].rotation)*l,d=a.transforms[s].rotation+h;a.triangle.draw(t,{x:r,y:o},a.scaleFactor*a.surface.scale,d+90)},this.setStart=function(t,e){a.startX=t,a.startY=e},this.setSurface=function(t){a.surface=t},this.transforms=e.transforms,this.color=e.color,this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0,this.triangle=new m({rotation:0}),this.scaleFactor=e.scaleFactor,this.stepFactor=e.stepFactor},g=a(37),w=a(38),y=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){var s,n=Object(w.a)(a.data);try{for(n.s();!(s=n.n()).done;){var r=s.value;if(!(r.read_at<=e))break;var o=r.x*a.surface.scale*a.scaleFactor+a.startX,i=r.y*a.surface.scale*a.scaleFactor+a.startY;S.draw(t,a.surface.scale*a.scaleFactor,o,i,a.color)}}catch(c){n.e(c)}finally{n.f()}},this.setSurface=function(t){a.surface=t},this.setStart=function(t,e){a.startX=t,a.startY=e},this.data=e.data,this.color=e.color,this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0,this.stepFactor=e.stepFactor,this.scaleFactor=e.scaleFactor},S=function(){function t(){Object(h.a)(this,t)}return Object(g.a)(t,null,[{key:"draw",value:function(t,e,a,s,n){t.fillStyle=n,t.strokeStyle=n,t.beginPath(),t.arc(a,s,e,0,2*Math.PI),t.stroke(),t.fill()}}]),t}(),b=function(t){var e=new d({color:"#343A40",scale:100}),a=new p({color:"white",positions:t.positions,scaleFactor:.3,stepFactor:.3}),s=new v({color:"green",transforms:t.positions,scaleFactor:.3,stepFactor:.3}),r=new y({color:"red",data:t.collisions,scaleFactor:.2,stepFactor:.3}),o=n.a.useRef(null),i=n.a.useRef(null),c=n.a.useRef(null),l=n.a.useRef(null),u=n.a.useRef(!1),f=n.a.useRef({start:null,elapsed:t.controller.time?t.controller.time:0});n.a.useEffect((function(){var t=i.current;c.current=t.getContext("2d");var n=h();return c.current.canvas.width=n,c.current.canvas.height=n,e.setWidth(n),e.setHeight(n),a.setStart(e.getCenter().x,e.getCenter().y),a.setSurface(e),s.setStart(e.getCenter().x,e.getCenter().y),s.setSurface(e),r.setStart(e.getCenter().x,e.getCenter().y),r.setSurface(e),e.draw(c.current),function(){return cancelAnimationFrame(l.current)}}));var h=function(t){var e=o.current.offsetWidth,a=o.current.offsetHeight,s=e<a?e:a;return s%2==0?s-23:s-24},m=function t(n){g(n),e.draw(c.current,f.current.elapsed),a.draw(c.current,f.current.elapsed),r.draw(c.current,f.current.elapsed),s.draw(c.current,f.current.elapsed),l.current=requestAnimationFrame(t)},g=function(e){null===f.current.start?(f.current.start=e,f.current.elapsed=0):f.current.elapsed=e-f.current.start,t.controller.time=f.current.elapsed};return n.a.createElement("div",{ref:o,className:"CanvasRoot"},n.a.createElement("canvas",{className:"Canvas",ref:i,onClick:function(t){u.current?(f.current={start:null,elapsed:null},e.draw(c.current),cancelAnimationFrame(l.current)):requestAnimationFrame(m),u.current=!u.current}}))},x=a(73),E=function(t){var e=n.a.useRef({isPlaying:!1,time:0}),a=n.a.useState({positions:[],collisions:[],duration:null}),s=Object(f.a)(a,2),r=s[0],o=s[1];n.a.useEffect((function(t){i()}),[t.session]);var i=function(){var e=Object(u.a)(c.a.mark((function e(a){var s,n,i,u,f,m,v,g,w,y;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="http://3.122.218.59/api/position/"+t.session.id,n="http://3.122.218.59/api/collision/"+t.session.id,i={headers:{"Content-Type":"application/json"}},u=[fetch(s,i),fetch(n,i)],e.next=6,Promise.all(u);case 6:return f=e.sent,m=[f[0].json(),f[1].json()],e.next=10,Promise.all(m);case 10:v=e.sent,g=h(v[0]),w=p(v[0]),y=d(w,v[1]),o(Object(l.a)(Object(l.a)({},r),{},{positions:w,collisions:y,duration:g}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(t){return(t[t.length-1].read_at-t[0].read_at)/1e3},d=function(t,e){return e.forEach((function(e){var a=t.find((function(t){return t.id===e.positionId}));a&&(e.x=a.x,e.y=a.y,e.read_at=a.read_at)})),e},p=function(t){for(var e=[],a=0;a<t.length;a++)0===a?e.push({id:t[0].id,read_at:0,x:0,y:0,rotation:t[0].rotation}):e.push({id:t[a].id,read_at:t[a].read_at-t[0].read_at,x:.05*(t[a].x-t[0].x),y:.05*(t[a].y-t[0].y),rotation:t[a].rotation});return e};return n.a.createElement("div",{className:"SessionViewRoot"},n.a.createElement("div",{className:"SessionInfo"},n.a.createElement(x.a,null,n.a.createElement("h1",{className:"display-3"},t.session.name),n.a.createElement("hr",{className:"my-2"}),n.a.createElement("p",{className:"SessionSmallInfo"},"Positions: ",n.a.createElement("strong",null,r.positions.length)),n.a.createElement("p",{className:"SessionSmallInfo"},"Collisions: ",n.a.createElement("strong",null,r.collisions.length)),n.a.createElement("p",{className:"SessionSmallInfo"},"Duration: ",n.a.createElement("strong",null,"".concat(r.duration,"s"))))),n.a.createElement("div",{className:"SessionVisualisation"},n.a.createElement(b,{positions:r.positions,collisions:r.collisions,controller:e.current})))},F=a(39),O=a.n(F),I=(a(54),a(74)),j=a(75),k=a(76),C=a(77),T=a(78),_=a(81),M=a(80),P=a(79),X=(a(55),function(t){var e=n.a.useState({navbarIsOpen:!1,dropDownIsOpen:!1}),a=Object(f.a)(e,2),s=a[0],r=a[1];return n.a.createElement("div",{className:"NavbarRoot"},n.a.createElement(I.a,{color:"dark",dark:!0,expand:"md"},n.a.createElement(j.a,null,"Path Visualization"),n.a.createElement(k.a,{onClick:function(t){return r(Object(l.a)(Object(l.a)({},s),{},{navbarIsOpen:!s.navbarIsOpen}))}}),n.a.createElement(C.a,{className:"mr-auto",navbar:!0},n.a.createElement(T.a,{disabled:t.dropdownIsDisabled,nav:!0,isOpen:s.dropDownIsOpen,toggle:function(t){return r(Object(l.a)(Object(l.a)({},s),{},{dropDownIsOpen:!s.dropDownIsOpen}))}},n.a.createElement(_.a,{nav:!0,caret:!0},"Sessions"),n.a.createElement(M.a,null,t.dropdownItems.map((function(e,a){return n.a.createElement(P.a,{id:a,key:a,onClick:t.onClickDropdown},e.name)})))))))});var Y=function(){var t=n.a.useState({sessions:[],activeSessionIndex:0,isFetching:!0}),e=Object(f.a)(t,2),a=e[0],s=e[1];n.a.useEffect((function(t){r()}),[]);var r=function(){var t=Object(u.a)(c.a.mark((function t(e){var n,r,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"http://3.122.218.59/api/session",n={headers:{"Content-Type":"application/json"}},t.prev=2,t.next=5,fetch("http://3.122.218.59/api/session",n);case 5:return r=t.sent,t.next=8,r.json();case 8:o=t.sent,s(Object(l.a)(Object(l.a)({},a),{},{sessions:o,isFetching:!1})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}();return n.a.createElement("div",{className:"App"},n.a.createElement(X,{dropdownIsDisabled:a.isFetching,dropdownItems:a.sessions,onClickDropdown:function(t){s(Object(l.a)(Object(l.a)({},a),{},{activeSessionIndex:t.target.id}))}}),a.isFetching?n.a.createElement("div",{className:"LoadAnimContainer"},n.a.createElement(O.a,{type:"spin",color:"#343A40",height:"10%",width:"10%"})):n.a.createElement(E,{session:a.sessions[a.activeSessionIndex]}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(71);o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(Y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.413604c3.chunk.js.map