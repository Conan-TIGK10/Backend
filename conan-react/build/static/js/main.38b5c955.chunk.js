(this["webpackJsonpconan-react"]=this["webpackJsonpconan-react"]||[]).push([[0],{43:function(t,e,a){t.exports=a(72)},48:function(t,e,a){},50:function(t,e,a){},51:function(t,e,a){},54:function(t,e,a){},55:function(t,e,a){},72:function(t,e,a){"use strict";a.r(e);var n=a(1),s=a.n(n),r=a(36),i=a.n(r),o=(a(48),a(17)),c=a.n(o),l=a(9),u=a(20),f=a(16),h=(a(50),a(11)),d=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){if(a.isScaling)if(a.scalingTimeElapsed>=a.scalingTime)a.isScaling=!1,a.scalingTimeStart=null,a.scalingTimeElapsed=null;else{a.scalingTimeElapsed=e-a.scalingTimeStart;var n=a.scalingTime/a.scalingTimeElapsed;a.scale-=a.scale/a.scalingDivider*n}t.fillStyle=a.color,t.fillRect(0,0,a.width,a.height)},this.setWidth=function(t){a.width=t},this.setHeight=function(t){a.height=t},this.getCenter=function(t){return{x:Math.floor(a.width/2),y:Math.floor(a.height/2)}},this.isInside=function(t,e,n,s){var r=t>=0,i=e>=0,o=s<=a.height,c=n<=a.width;return r&&i&&o&&c},this.startScaleDown=function(t){a.isScaling=!0,a.scalingTimeStart=t},this.width=e.width?e.width:0,this.height=e.height?e.height:0,this.scale=e.scale?e.scale:1,this.color=e.color?e.color:"black",this.scalingTime=500,this.scalingDivider=4,this.scalingTimeElapsed=null,this.scalingTimeStart=null,this.isScaling=!1},m=(a(51),function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){t.strokeStyle=a.color;var n=!1;t.lineWidth=a.surface.scale/2,t.beginPath(),t.moveTo(a.startX,a.startY);for(var s=0;s<a.positions.length-1&&!(a.positions[s].read_at>e);s++){var r=a.startX,i=a.startY;if(a.positions[s+1].read_at>e){var o=a.positions[s+1].read_at-a.positions[s].read_at,c=(e-a.positions[s].read_at)/o,l=(a.positions[s+1].x-a.positions[s].x)*c,u=(a.positions[s+1].y-a.positions[s].y)*c;r+=(a.positions[s].x+l)*a.surface.scale,i+=(a.positions[s].y+u)*a.surface.scale}else r+=a.positions[s+1].x*a.surface.scale,i+=a.positions[s+1].y*a.surface.scale;var f=a.surface.scale<=1?0:Math.floor(a.surface.scale/2),h=r-f,d=i-f,m=r+f,p=i+f;if(!a.surface.isInside(d,h,m,p)){a.surface.scale=Math.floor(a.surface.scale-a.surface.scale/4),n=!0;break}t.lineTo(r,i),t.stroke()}n&&(a.surface.draw(t),a.draw(t,e))},this.setStart=function(t,e){a.startX=t,a.startY=e},this.setSurface=function(t){a.surface=t},this.color=e.color?e.color:"black",this.collisionColor=e.collisionColor?e.collisionColor:"red",this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0,this.positions=e.positions}),p=function t(){var e=this;Object(h.a)(this,t),this.draw=function(t,a,n,s){e.scale=n,e.rotation=s;var r={x:a.x+Math.cos((90-e.rotation)*Math.PI/180)*e.scale,y:a.y+-Math.sin((90-e.rotation)*Math.PI/180)*e.scale},i={x:a.x+Math.cos(-e.rotation*Math.PI/180)*e.scale/2,y:a.y+-Math.sin(-e.rotation*Math.PI/180)*e.scale/2},o={x:a.x+Math.cos((180-e.rotation)*Math.PI/180)*e.scale/2,y:a.y+-Math.sin((180-e.rotation)*Math.PI/180)*e.scale/2};t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(i.x,i.y),t.lineTo(o.x,o.y),t.closePath(),t.strokeStyle="green",t.stroke(),t.fillStyle="green",t.fill()}},v=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){for(var n=null,s=null,r=a.startX,i=a.startY,o=0;o<a.transforms.length-1;o++){if(o===a.transforms.length-1||0===e){n=o,s=o;break}if(a.transforms[o+1].read_at>e){n=o,s=o+1;break}}var c=a.transforms[s].read_at-a.transforms[n].read_at,l=(e-a.transforms[n].read_at)/c,u=(a.transforms[s].x-a.transforms[n].x)*l,f=(a.transforms[s].y-a.transforms[n].y)*l;r+=(a.transforms[n].x+u)*a.surface.scale,i+=(a.transforms[n].y+f)*a.surface.scale,a.triangle.draw(t,{x:r,y:i},a.surface.scale,a.transforms[n].rotation)},this.setStart=function(t,e){a.startX=t,a.startY=e},this.setSurface=function(t){a.surface=t},this.transforms=e.transforms,this.color=e.color,this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0,this.triangle=new p({rotation:0})},g=a(37),w=a(38),y=function t(e){var a=this;Object(h.a)(this,t),this.draw=function(t,e){var n,s=Object(w.a)(a.data);try{for(s.s();!(n=s.n()).done;){var r=n.value;if(!(r.read_at<=e))break;var i=r.x*a.surface.scale+a.startX,o=r.y*a.surface.scale+a.startY;S.draw(t,a.surface.scale/2,i,o,a.color)}}catch(c){s.e(c)}finally{s.f()}},this.setSurface=function(t){a.surface=t},this.setStart=function(t,e){a.startX=t,a.startY=e},this.data=e.data,this.color=e.color,this.startX=e.startX?e.startX:0,this.startY=e.startY?e.startY:0},S=function(){function t(){Object(h.a)(this,t)}return Object(g.a)(t,null,[{key:"draw",value:function(t,e,a,n,s){t.fillStyle=s,t.strokeStyle=s,t.beginPath(),t.arc(a,n,e,0,2*Math.PI),t.stroke(),t.fill()}}]),t}(),b=function(t){var e=new d({color:"#343A40",scale:100}),a=new m({color:"white",positions:t.positions}),n=new v({color:"green",transforms:t.positions}),r=new y({color:"red",data:t.collisions}),i=s.a.useRef(null),o=s.a.useRef(null),c=s.a.useRef(null),l=s.a.useRef(null),u=s.a.useRef(!1),f=s.a.useRef({start:null,elapsed:t.controller.time?t.controller.time:0});s.a.useEffect((function(){var t=o.current;c.current=t.getContext("2d");var s=h();return c.current.canvas.width=s,c.current.canvas.height=s,e.setWidth(s),e.setHeight(s),a.setStart(e.getCenter().x,e.getCenter().y),a.setSurface(e),n.setStart(e.getCenter().x,e.getCenter().y),n.setSurface(e),r.setStart(e.getCenter().x,e.getCenter().y),r.setSurface(e),e.draw(c.current),function(){return cancelAnimationFrame(l.current)}}));var h=function(t){var e=i.current.offsetWidth,a=i.current.offsetHeight,n=e<a?e:a;return n%2==0?n-23:n-24},p=function t(s){g(s),e.draw(c.current,f.current.elapsed),a.draw(c.current,f.current.elapsed),r.draw(c.current,f.current.elapsed),n.draw(c.current,f.current.elapsed),l.current=requestAnimationFrame(t)},g=function(e){null===f.current.start?(f.current.start=e,f.current.elapsed=0):f.current.elapsed=e-f.current.start,t.controller.time=f.current.elapsed};return s.a.createElement("div",{ref:i,className:"CanvasRoot"},s.a.createElement("canvas",{className:"Canvas",ref:o,onClick:function(a){u.current?(f.current={start:null,elapsed:null},e.draw(c.current),cancelAnimationFrame(l.current)):(t.controller.isPlaying=!0,requestAnimationFrame(p)),u.current=!u.current}}))},E=a(73),x=function(t){var e=s.a.useState({positions:[],collisions:[],duration:null}),a=Object(f.a)(e,2),n=a[0],r=a[1];s.a.useEffect((function(t){i()}),[t.session]);var i=function(){var e=Object(u.a)(c.a.mark((function e(a){var s,i,u,f,d,m,p,v,g;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="http://3.122.218.59/api/position/"+t.session.id,i="http://3.122.218.59/api/collision/"+t.session.id,u={headers:{"Content-Type":"application/json"}},f=[fetch(s,u),fetch(i,u)],e.next=6,Promise.all(f);case 6:return d=e.sent,m=[d[0].json(),d[1].json()],e.next=10,Promise.all(m);case 10:p=e.sent,v=o(p[0]),g=h(p[0],p[1]),r(Object(l.a)(Object(l.a)({},n),{},{positions:p[0],collisions:g,duration:v}));case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o=function(t){return(t[t.length-1].read_at-t[0].read_at)/1e3},h=function(t,e){return e.forEach((function(e){var a=t.find((function(t){return t.id===e.positionId}));a&&(e.x=a.x,e.y=a.y,e.read_at=a.read_at)})),e};return s.a.createElement("div",{className:"SessionViewRoot"},s.a.createElement("div",{className:"SessionInfo"},s.a.createElement(E.a,null,s.a.createElement("h1",{className:"display-3"},t.session.name),s.a.createElement("hr",{className:"my-2"}),s.a.createElement("p",{className:"SessionSmallInfo"},"Positions: ",s.a.createElement("strong",null,n.positions.length)),s.a.createElement("p",{className:"SessionSmallInfo"},"Collisions: ",s.a.createElement("strong",null,n.collisions.length)),s.a.createElement("p",{className:"SessionSmallInfo"},"Duration: ",s.a.createElement("strong",null,"".concat(n.duration,"s"))))),s.a.createElement("div",{className:"SessionVisualisation"},s.a.createElement(b,{positions:n.positions,collisions:n.collisions,controller:{isPlaying:!1,time:0}})))},O=a(39),I=a.n(O),j=(a(54),a(74)),k=a(75),C=a(76),T=a(77),M=a(78),P=a(81),X=a(80),Y=a(79),N=(a(55),function(t){var e=s.a.useState({navbarIsOpen:!1,dropDownIsOpen:!1}),a=Object(f.a)(e,2),n=a[0],r=a[1];return s.a.createElement("div",{className:"NavbarRoot"},s.a.createElement(j.a,{color:"dark",dark:!0,expand:"md"},s.a.createElement(k.a,null,"Path Visualization"),s.a.createElement(C.a,{onClick:function(t){return r(Object(l.a)(Object(l.a)({},n),{},{navbarIsOpen:!n.navbarIsOpen}))}}),s.a.createElement(T.a,{className:"mr-auto",navbar:!0},s.a.createElement(M.a,{disabled:t.dropdownIsDisabled,nav:!0,isOpen:n.dropDownIsOpen,toggle:function(t){return r(Object(l.a)(Object(l.a)({},n),{},{dropDownIsOpen:!n.dropDownIsOpen}))}},s.a.createElement(P.a,{nav:!0,caret:!0},"Sessions"),s.a.createElement(X.a,null,t.dropdownItems.map((function(e,a){return s.a.createElement(Y.a,{id:a,key:a,onClick:t.onClickDropdown},e.name)})))))))});var _=function(){var t=s.a.useState({sessions:[],activeSessionIndex:0,isFetching:!0}),e=Object(f.a)(t,2),a=e[0],n=e[1];s.a.useEffect((function(t){r()}),[]);var r=function(){var t=Object(u.a)(c.a.mark((function t(e){var s,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"http://3.122.218.59/api/session",s={headers:{"Content-Type":"application/json"}},t.prev=2,t.next=5,fetch("http://3.122.218.59/api/session",s);case 5:return r=t.sent,t.next=8,r.json();case 8:i=t.sent,n(Object(l.a)(Object(l.a)({},a),{},{sessions:i,isFetching:!1})),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e){return t.apply(this,arguments)}}();return s.a.createElement("div",{className:"App"},s.a.createElement(N,{dropdownIsDisabled:a.isFetching,dropdownItems:a.sessions,onClickDropdown:function(t){n(Object(l.a)(Object(l.a)({},a),{},{activeSessionIndex:t.target.id}))}}),a.isFetching?s.a.createElement("div",{className:"LoadAnimContainer"},s.a.createElement(I.a,{type:"spin",color:"#343A40",height:"10%",width:"10%"})):s.a.createElement(x,{session:a.sessions[a.activeSessionIndex]}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(71);i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.38b5c955.chunk.js.map